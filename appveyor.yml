version: 1.0.{build}-{branch}

branches:
  only:
    - master

image:
 - Visual Studio 2019

platform:
  - x64
  - x86
  - amd64

init:
  - git config --global core.autocrlf input

stack: node 18.12.0

cache:
  - node_modules

install:
 - yarn

build: off

after_build:
  - yarn run build
  - yarn run lint

deploy: off

deploy_script:  # скрипт развёртывания
# https://www.appveyor.com/docs/how-to/git-push/
# https://www.appveyor.com/docs/how-to/git-push/#adding-access-token-to-credential-store
  - git config --global credential.helper store #включает кеширование учетных данных
  - git config --global user.name Tryd0g0lik
  - git config --global user.email work80@mail.ru
  # При аутентификации с помощью токена доступа `x-oauth-basic` используется в качестве заглушки пароля
  #- ps: Set-Content -Path  "$HOME/.git-credentials" -Value "https://$GITHUB_TOKEN:x-oauth-basic@github.com"  -NoNewline
  - ps: Write-Host "https://$GITHUB_TOKEN:x-oauth-basic@github.com" > "$HOME/.git-credentials" -NoNewline

  - yarn add push-dir --dir=dist --branch=master --force --verbose
